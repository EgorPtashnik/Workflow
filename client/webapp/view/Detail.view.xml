<mvc:View
  controllerName='client.controller.Detail'
  displayBlock='true'
  xmlns:m='sap.m'
  xmlns='sap.uxap'
  xmlns:mvc='sap.ui.core.mvc'>
  <ObjectPageLayout sections='{path: "store>/selectedProject/cards", sorter: { path: "createdAt" }}'>
    <headerTitle>
      <ObjectPageHeader objectTitle='{store>/selectedProject/name}'
        objectSubtitle='{store>/selectedProject/desc}'
        objectImageURI='resources/img/project.jpg'>
        <actions>
          <ObjectPageHeaderActionButton type='Emphasized' press='openCreateCardDialog' hideText='false' hideIcon='true' text='{i18n>createNewCard}'/>
          <ObjectPageHeaderActionButton hideText='false' hideIcon='true' text='{i18n>edit}' press='openEditProjectDialog'/>
          <ObjectPageHeaderActionButton type='Transparent' hideText='false' hideIcon='true' text='{i18n>projects}' press='onGoProjects'/>
        </actions>
      </ObjectPageHeader>
    </headerTitle>

    <sections>
      <ObjectPageSection titleUppercase='false' title='{store>name}'>
        <ObjectPageSubSection>
          <m:VBox class='list_wrapper'>
            <m:List noDataText='{i18n>noTasks}' itemPress='onChangeListItemStatus' delete='onDeleteTask' items='{path: "store>items", templateShareable: "false"}'>
              <m:headerToolbar>
                <m:Toolbar>
                  <m:Input class='input' placeholder='{i18n>newTask}' submit='onCreateTask($event, ${store>ID})'/>
                  <m:ToolbarSpacer/>
                  <m:ToggleButton type='Reject' icon='sap-icon://delete' press='onChangeListMode'/>
                </m:Toolbar>
              </m:headerToolbar>
              <m:StandardListItem wrapping='true' type='Active' title='{store>name}' highlight='{=${store>done} === 0? "Error" : "Success"}'
                info='{=${store>done} === 0? "In Progress" : "Done"}' infoState='{=${store>done} === 0? "Error" : "Success"}'/>
            </m:List>
          </m:VBox>
        </ObjectPageSubSection>
      </ObjectPageSection>
    </sections>
  </ObjectPageLayout>

  <m:Dialog title='{i18n>createNewCard}' id='idCreateCardDialog'>
    <m:VBox class='sapUiTinyMargin'>
      <m:Label text='{i18n>newCardName}'/>
      <m:Input value='{state>/newCardName}' submit='onCreateCard'/>
    </m:VBox>
    <m:buttons>
      <m:Button type='Emphasized' press='onCreateCard' text='{i18n>submit}'/>
      <m:Button type='Transparent' text='{i18n>cancel}' press='closeDialog'/>
    </m:buttons>
  </m:Dialog>

  <m:Dialog title='{i18n>editProject}' id='idEditProjectDialog'>
    <m:VBox class='sapUiTinyMargin'>
      <m:Label text='{i18n>projectName}:'/>
      <m:Input value='{store>/selectedProject/name}'/>
      <m:Label text='{i18n>projectDesc}'/>
      <m:TextArea growing='true' width='100%' value='{store>/selectedProject/desc}'/>
      <m:List noDataText='{i18n>noCards}' mode='Delete' delete='onDeleteCard' items='{path: "store>/selectedProject/cards", sorter: { path: "createdAt" } }'>
        <m:StandardListItem title="{store>name}" info="{store>items/length} items" infoState="Information"/>
      </m:List>
    </m:VBox>
    <m:buttons>
      <m:Button type='Emphasized' text='{i18n>submit}' press='onUpdateProject'/>
      <m:Button type='Transparent' text='{i18n>close}' press='closeDialog'/>
    </m:buttons>
  </m:Dialog>
</mvc:View>
